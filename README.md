# webpack-blocks-happypack

[![Generated with nod](https://img.shields.io/badge/generator-nod-2196F3.svg?style=flat-square)](https://github.com/diegohaz/nod)
[![NPM version](https://img.shields.io/npm/v/webpack-blocks-happypack.svg?style=flat-square)](https://npmjs.org/package/webpack-blocks-happypack)
[![Build Status](https://img.shields.io/travis/diegohaz/webpack-blocks-happypack/master.svg?style=flat-square)](https://travis-ci.org/diegohaz/webpack-blocks-happypack) [![Coverage Status](https://img.shields.io/codecov/c/github/diegohaz/webpack-blocks-happypack/master.svg?style=flat-square)](https://codecov.io/gh/diegohaz/webpack-blocks-happypack/branch/master)

A webpack block that adds [happypack](https://github.com/amireh/happypack) support to your webpack config.

This package is based on the [PR](https://github.com/andywer/webpack-blocks/pull/126) by [**@fenos**](https://github.com/fenos) on the official [webpack-blocks](https://github.com/andywer/webpack-blocks) repository.

## Install

    $ npm install --save-dev webpack-blocks-happypack

## Usage

### Basic

```js
const { createConfig } = require('@webpack-blocks/webpack2')
const babel = require('@webpack-blocks/babel6')
const cssModules = require('@webpack-blocks/css-modules')
const extractText = require('@webpack-blocks/extract-text2')
const happypack = require('webpack-blocks-happypack')

const config = createConfig([
  cssModules(),
  happypack([
    // these will be happypack'd
    extractText(),
    babel(),
  ]),
])
```

### Configuration

```js
const config = createConfig([
  happypack([
    babel(),
  ], {
    // default options
    loaders: ['babel-loader', 'css-loader'], // allowed loaders
    cache: !process.env.DISABLE_HAPPY_CACHE,
    cacheContext: {
      env: process.env.NODE_ENV,
      refresh: process.env.REFRESH_HAPPY_CACHE ? Math.random() : 0,
      // ... add or override happypack cacheContext options
    },
    // ... add or override happypack options
  }),
])
```

### Environment variables

```sh
$ DISABLE_HAPPY=true webpack # turns happypack off and run webpack
$ DISABLE_HAPPY_CACHE=true webpack # turns happypack cache off and run webpack
$ REFRESH_HAPPY_CACHE=true webpack # refreshes happypack cache and run webpack
```

## How it does

This webpack block adds `HappyPack` plugins with proper IDs and replaces loaders by `happypack/loader?id=${id}`.

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### happypack

**Parameters**

-   `blocks` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[WebpackBlock](#webpackblock)>** 
-   `$1` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)**  (optional, default `{}`)
    -   `$1.loaders`   (optional, default `['babel-loader', 'css-loader']`)
    -   `$1.happypackOptions` **...any** 

Returns **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Block](#block)>** 

### Loader

Type: [string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)

### Rule

Type: {test: [RegExp](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp), loader: ([Loader](#loader) \| [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Loader](#loader)>)?, loaders: ([Loader](#loader) \| [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Loader](#loader)>)?, use: ([Loader](#loader) \| [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Loader](#loader)>)?}

### Block

Type: {plugins: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;any>?, module: {loaders: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Rule](#rule)>?, rules: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[Rule](#rule)>?}}

### BlockOptions

Type: {loaders: [Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)&lt;[string](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)>?, refresh: [boolean](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean)?, cache: any?, cacheContext: {}?}

### WebpackBlock

Type: function (): [Block](#block)

## Other useful webpack blocks

-   [`webpack-blocks-split-vendor`](https://github.com/diegohaz/webpack-blocks-split-vendor)

## License

MIT Â© [Diego Haz](https://github.com/diegohaz)
